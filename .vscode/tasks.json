{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Build Debug APK",
            "type": "shell",
            "command": "./gradlew",
            "args": ["assembleDebug"],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Install APK",
            "type": "shell",
            "command": "adb install -r app/build/outputs/apk/debug/app-debug.apk",
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Build and Install",
            "dependsOrder": "sequence",
            "dependsOn": [
                "Build Debug APK",
                "Install APK"
            ],
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Launch App",
            "type": "shell",
            "command": "adb shell am start -n com.godtap.dictionary/com.godtap.dictionary.MainActivity",
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Stop App",
            "type": "shell",
            "command": "adb shell am force-stop com.godtap.dictionary",
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Clear App Data",
            "type": "shell",
            "command": "adb shell pm clear com.godtap.dictionary",
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Logcat - All",
            "type": "shell",
            "command": "adb logcat",
            "isBackground": true,
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "dedicated"
            }
        },
        {
            "label": "Logcat - App Only",
            "type": "shell",
            "command": "powershell",
            "args": ["-Command", "adb logcat | Select-String 'com.godtap.dictionary'"],
            "isBackground": true,
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "dedicated"
            }
        },
        {
            "label": "Logcat - TextSelectionService",
            "type": "shell",
            "command": "adb",
            "args": ["logcat", "TextSelectionService:D", "OverlayManager:D", "*:S"],
            "isBackground": true,
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "dedicated"
            }
        },
        {
            "label": "Clear Logcat",
            "type": "shell",
            "command": "adb logcat -c",
            "problemMatcher": [],
            "presentation": {
                "reveal": "silent",
                "panel": "shared"
            }
        },
        {
            "label": "Build, Install and Launch with Logcat",
            "dependsOrder": "sequence",
            "dependsOn": [
                "Build Debug APK",
                "Stop App",
                "Install APK",
                "Clear Logcat",
                "Launch App",
                "Logcat - TextSelectionService"
            ],
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Quick Deploy",
            "dependsOrder": "sequence",
            "dependsOn": [
                "Build Debug APK",
                "Install APK",
                "Stop App"
            ],
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "DB: Query Entry",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-Command",
                "$word = Read-Host 'Enter word to search'; adb exec-out \"run-as com.godtap.dictionary cat databases/dictionary_database\" > temp.db; sqlite3 temp.db \"SELECT id, primaryExpression, primaryReading, substr(senses, 1, 200) as senses_preview FROM dictionary_entries WHERE primaryExpression = '$word' OR primaryReading = '$word' LIMIT 5;\"; Remove-Item temp.db"
            ],
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "focus": true
            }
        },
        {
            "label": "DB: Count Entries",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-Command",
                "adb exec-out \"run-as com.godtap.dictionary cat databases/dictionary_database\" > temp.db; Write-Host \"Total entries:\"; sqlite3 temp.db 'SELECT COUNT(*) FROM dictionary_entries;'; Write-Host \"Entries with glosses:\"; sqlite3 temp.db 'SELECT COUNT(*) FROM dictionary_entries WHERE senses LIKE ''%glosses%'';'; Write-Host \"Sample entry:\"; sqlite3 temp.db 'SELECT primaryExpression, primaryReading, substr(senses, 1, 300) FROM dictionary_entries LIMIT 1;'; Remove-Item temp.db"
            ],
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "focus": true
            }
        },
        {
            "label": "DB: Sample Entries",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-Command",
                "adb exec-out \"run-as com.godtap.dictionary cat databases/dictionary_database\" > temp.db; sqlite3 temp.db \"SELECT primaryExpression, primaryReading, lookupCount, substr(senses, 1, 150) as senses_sample FROM dictionary_entries WHERE lookupCount > 0 ORDER BY lookupCount DESC LIMIT 10;\"; Remove-Item temp.db"
            ],
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "focus": true
            }
        },
        {
            "label": "DB: Check Word Glosses",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-File",
                "${workspaceFolder}/scripts/check_word.ps1"
            ],
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "focus": true
            }
        },
        {
            "label": "DB: List All Dictionaries",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-Command",
                "adb exec-out \"run-as com.godtap.dictionary cat databases/dictionary_database\" > temp.db; Write-Host \"\\nInstalled Dictionaries:\\n\"; sqlite3 temp.db \"SELECT id, name, sourceLanguage, targetLanguage, enabled, entryCount FROM dictionary_metadata;\"; Remove-Item temp.db"
            ],
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "focus": true
            }
        }
    ]
}
